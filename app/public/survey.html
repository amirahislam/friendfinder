<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- <link rel="stylesheet" type="text/css" media="screen" href="main.css" /> -->
    <!-- <script src="main.js"></script> -->
</head>
<body>

    <div class="container">
        <h1> Survey Questions</h1>
        <hr>
        <br>
        
        <form>
                <div class="form-group">
                  <label for="name">Name (Required)</label>
                  <input type="name" class="form-control" id="inputName" aria-describedby="nameHelp" placeholder="Enter Name">
                </div>
                <div class="form-group">
                    <label for="pasteImage">Link to image (Required)</label>
                    <input type="putImage" class="form-control" id="inputImage" aria-describedby="nameHelp" placeholder="Paste Image Link">
                </div>
                
                <h2>Question 1</h2><hr>
               <h3>How much do you love Harry Potter books?</h3>
               <select class="chosen-select" id="q1">
                   <option value></option>
                   <option value="1">1 (Not Really.)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Very much so!)</option>
               </select>
               <br>
               <br>

               <h2>Question 2</h2><hr>
               <h3>Do you like cilantro?</h3>
               <select class="chosen-select" id="q2">
                   <option value></option>
                   <option value="1">1 (Meh, not really.)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Yas! Cilantro is lyf!)</option>
               </select>
               <br>
               <br>

               <h2>Question 3</h2><hr>
               <h3>Sriracha?</h3>
               <select class="chosen-select" id="q3">
                   <option value></option>
                   <option value="1">1 (Too spicy!)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (On everything!)</option>
               </select>
               <br>
               <br>

               <h2>Question 4</h2><hr>
               <h3>Do you feel like you get sad if you don't get enough "likes" on your posts?</h3>
               <select class="chosen-select" id="q4">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select>
               <br>
               <br>

               <h2>Question 5</h2><hr>
               <h3>Test question here.</h3>
               <select class="chosen-select" id="q5">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select>
               <br>
               <br>

               <h2>Question 6</h2><hr>
               <h3>Test question here.</h3>
               <select class="chosen-select" id="q6">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select>
               <br>
               <br>

               <h2>Question 7</h2><hr>
               <h3>Test question here.</h3>
               <select class="chosen-select" id="q7">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select>
               <br>
               <br>

               <h2>Question 8</h2><hr>
               <h3>Test question here.</h3>
               <select class="chosen-select" id="q8">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select>
               <br>
               <br>

               <h2>Question 9</h2><hr>
               <h3>Test question here.</h3>
               <select class="chosen-select" id="q9">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select>
               <br>
               <br>

               <h2>Question 10</h2><hr>
               <h3>Test question here.</h3>
               <select class="chosen-select" id="q10">
                   <option value></option>
                   <option value="1">1 (Strongly Disagree)</option>
                   <option value="2">2</option>
                   <option value="3">3</option>
                   <option value="4">4</option>
                   <option value="5">5 (Strongly Agree)</option>
               </select><br>
                <br>
                <br>
               
                <button type="submit" class="btn btn-warning" id="submit">Submit</button>
              </form>
        </div>
    
</body>
</html>

<script type="text/javascript">

    var newFriend;
    
    $("#submit").on("click", function(event) {
      event.preventDefault();
      // Here we grab the form elements
        newFriend = {
           name: $("#inputName").val().trim(),
           photo: $("#inputImage").val().trim(),
           scores: [
               $("#q1").val().trim(),
               $("#q2").val().trim(),
               $("#q3").val().trim(),
               $("#q4").val().trim(),
               $("#q5").val().trim(),
               $("#q6").val().trim(),
               $("#q7").val().trim(),
               $("#q8").val().trim(),
               $("#q9").val().trim(),
               $("#q10").val().trim(),
           ]
       };
      console.log(newFriend);
      
      $.post("/api/friends", newFriend,
        function(data) {
            console.log("something");
         
         if (data) {
            alert("Yas! You are about to meet a new friend!");
          }
          
          else {
            alert("Hold on! You've already submitted a profile!");
          }
          // Clear the form when submitting
          name: $("#inputName").val("");
           photo: $("#inputImage").val("");
           scores: [
               $("#q1").val(""),
               $("#q2").val(""),
               $("#q3").val(""),
               $("#q4").val(""),
               $("#q5").val(""),
               $("#q6").val(""),
               $("#q7").val(""),
               $("#q8").val(""),
               $("#q9").val(""),
               $("#q10").val(""),
           ]
        });

        findFriends();


    function findFriends () {
    var currentURL = window.location.origin;
    var scoresArray = [];
    var bestFriend;
    

        $.ajax({ url: currentURL + "/api/friends", method: "GET"})
            .then(function(friends) {
                console.log("URL: " + currentURL + "/api/friends");
                console.log(friends);
                console.log(friends.length);
        
        for (var i = 0; i < friends.length; i++) {
            console.log(friends[i].scores);
            if (newFriend.name !== friends[i].name) {
                scoresArray.push(friends[i].scores);
            };

            console.log(scoresArray);
            var diffArray =[];

            for (var j=0; j < scoresArray.length; j++) {
                
                var thisDiff = 0;
                console.log("Compare me: ");
                console.log(newFriend);
                console.log("---------------------");
                console.log(scoresArray[j]);
                console.log(newFriend.scores);
                console.log("---------------------");

            for (var z = 0; z < 10; z++ ) {
                console.log(Math.abs(newFriend.scores[z] - scoresArray[j][z]));
                        var diff = Math.abs(newFriend.scores[z] - scoresArray[j][z]);
                        thisDiff = thisDiff + diff;
            };

            

            }
        }
        

        })

    }
   });

    


</script>
